<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QuickBite - Food Delivery Service</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Work+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Work Sans', sans-serif; }
    .title-font { font-family: 'Bebas Neue', sans-serif; letter-spacing: 0.05em; }
    .brutalist-card { border: 3px solid #fff; box-shadow: 8px 8px 0 #ff6b35; transition: all 0.2s ease; }
    .brutalist-card:hover { transform: translate(-4px, -4px); box-shadow: 12px 12px 0 #ff6b35; }
    .accent-shadow { box-shadow: 4px 4px 0 #00d9ff; }
    .btn-primary { background: #ff6b35; border: 3px solid #fff; box-shadow: 4px 4px 0 #fff; transition: all 0.15s ease; cursor: pointer; }
    .btn-primary:hover { transform: translate(-2px, -2px); box-shadow: 6px 6px 0 #fff; }
    .btn-primary:active { transform: translate(1px, 1px); box-shadow: 2px 2px 0 #fff; }
    .btn-secondary { background: transparent; border: 2px solid #fff; transition: all 0.15s ease; cursor: pointer; }
    .btn-secondary:hover { background: #fff; color: #000; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    .animate-slide-up { animation: slideUp 0.4s ease-out forwards; }
    .grid-pattern {
      background-image: linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
      background-size: 30px 30px;
    }
    .step-active { background: #ff6b35; border-color: #ff6b35; }
    .step-done { background: #00d9ff; border-color: #00d9ff; }
    .step-inactive { background: transparent; border-color: #444; }
    .step-line-done { background: #00d9ff; }
    .step-line-inactive { background: #444; }
    .chat-bubble-user { background: #ff6b35; border-radius: 12px 12px 2px 12px; }
    .chat-bubble-bot { background: #1a1a1a; border: 1px solid #333; border-radius: 12px 12px 12px 2px; }
    input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useCallback, useRef } = React;
    const API_URL = 'http://localhost:3001/api';

    // ‚îÄ‚îÄ Mock Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const MOCK_USERS = [
      { id: 1, name: 'Demo User',  email: 'demo@quickbite.com', password: 'password', phone: '555-0100' },
      { id: 2, name: 'Jane Smith', email: 'jane@example.com',   password: 'jane123',  phone: '555-0101' },
    ];

    const MOCK_COURIERS = [
      { id: 1, name: 'Marcus T.',  phone: '555-0201', vehicle: 'Blue Honda Civic',  avatar: 'üßë' },
      { id: 2, name: 'Priya K.',   phone: '555-0202', vehicle: 'Red Toyota Corolla',avatar: 'üë©' },
      { id: 3, name: 'Devon R.',   phone: '555-0203', vehicle: 'Black Ford Focus',  avatar: 'üßî' },
      { id: 4, name: 'Aisha M.',   phone: '555-0204', vehicle: 'White Nissan Sentra',avatar: 'üë±‚Äç‚ôÄÔ∏è' },
    ];

    const COURIER_SCRIPTS = [
      "I've picked up your order and I'm on my way! üöó",
      "Traffic is light today, should be there soon!",
      "I'm about 5 minutes away from your location.",
      "Just turned onto your street, look out for me!",
      "Arrived! I'll be at your door in a moment üôÇ",
    ];

    const MOCK_RESTAURANTS = [
      { id: 1, name: "Sakura Sushi",    cuisine: "Japanese", rating: 4.8, deliveryTime: "25-35 min", deliveryFee: 2.99, image: "üç£" },
      { id: 2, name: "Mama's Pizzeria", cuisine: "Italian",  rating: 4.6, deliveryTime: "30-40 min", deliveryFee: 1.99, image: "üçï" },
      { id: 3, name: "Taco Fiesta",     cuisine: "Mexican",  rating: 4.7, deliveryTime: "20-30 min", deliveryFee: 2.49, image: "üåÆ" },
      { id: 4, name: "Green Bowl",      cuisine: "Healthy",  rating: 4.9, deliveryTime: "15-25 min", deliveryFee: 3.49, image: "ü•ó" },
      { id: 5, name: "Burger Palace",   cuisine: "American", rating: 4.5, deliveryTime: "25-35 min", deliveryFee: 2.99, image: "üçî" },
      { id: 6, name: "Spice Route",     cuisine: "Indian",   rating: 4.8, deliveryTime: "35-45 min", deliveryFee: 2.49, image: "üçõ" },
    ];

    const MOCK_MENUS = {
      1: [
        { id: 101, name: "California Roll",  price: 12.99, description: "Crab, avocado, cucumber",        category: "Rolls"  },
        { id: 102, name: "Spicy Tuna Roll",  price: 14.99, description: "Tuna, spicy mayo, cucumber",     category: "Rolls"  },
        { id: 103, name: "Salmon Nigiri",    price:  8.99, description: "2 pieces of fresh salmon",       category: "Nigiri" },
        { id: 104, name: "Miso Soup",        price:  3.99, description: "Traditional soybean soup",       category: "Sides"  },
        { id: 105, name: "Edamame",          price:  5.99, description: "Steamed soybeans with sea salt", category: "Sides"  },
      ],
      2: [
        { id: 201, name: "Margherita Pizza", price: 13.99, description: "Tomato sauce, mozzarella, basil", category: "Pizza"    },
        { id: 202, name: "Pepperoni Pizza",  price: 15.99, description: "Classic pepperoni & cheese",      category: "Pizza"    },
        { id: 203, name: "Caesar Salad",     price:  8.99, description: "Romaine, parmesan, croutons",     category: "Salads"   },
        { id: 204, name: "Garlic Bread",     price:  5.99, description: "Toasted with garlic butter",      category: "Sides"    },
        { id: 205, name: "Tiramisu",         price:  6.99, description: "Classic Italian dessert",         category: "Desserts" },
      ],
      3: [
        { id: 301, name: "Carne Asada Tacos", price: 11.99, description: "3 tacos with grilled beef",    category: "Tacos"       },
        { id: 302, name: "Chicken Burrito",   price: 10.99, description: "Rice, beans, cheese, chicken", category: "Burritos"    },
        { id: 303, name: "Guacamole & Chips", price:  7.99, description: "Fresh avocado dip",            category: "Appetizers"  },
        { id: 304, name: "Quesadilla",        price:  9.99, description: "Cheese & chicken",             category: "Quesadillas" },
        { id: 305, name: "Churros",           price:  5.99, description: "Cinnamon sugar churros",       category: "Desserts"    },
      ],
      4: [
        { id: 401, name: "Buddha Bowl",    price: 13.99, description: "Quinoa, avocado, greens, tahini",     category: "Bowls"     },
        { id: 402, name: "Acai Bowl",      price: 11.99, description: "Acai, granola, fresh berries",        category: "Bowls"     },
        { id: 403, name: "Green Smoothie", price:  7.99, description: "Spinach, banana, mango, almond milk", category: "Drinks"    },
        { id: 404, name: "Avocado Toast",  price:  9.99, description: "Sourdough, avocado, cherry tomatoes", category: "Breakfast" },
        { id: 405, name: "Chia Pudding",   price:  6.99, description: "Coconut milk, chia seeds, berries",   category: "Desserts"  },
      ],
      5: [
        { id: 501, name: "Classic Burger",      price: 11.99, description: "Beef patty, lettuce, tomato, cheese", category: "Burgers" },
        { id: 502, name: "Double Bacon Burger", price: 15.99, description: "Two patties, bacon, cheddar",          category: "Burgers" },
        { id: 503, name: "Sweet Potato Fries",  price:  5.99, description: "Crispy sweet potato fries",            category: "Sides"   },
        { id: 504, name: "Onion Rings",         price:  6.99, description: "Beer-battered onion rings",            category: "Sides"   },
        { id: 505, name: "Milkshake",           price:  5.99, description: "Vanilla, chocolate, or strawberry",    category: "Drinks"  },
      ],
      6: [
        { id: 601, name: "Chicken Tikka Masala", price: 14.99, description: "Creamy tomato curry with chicken",    category: "Curry"      },
        { id: 602, name: "Vegetable Biryani",    price: 12.99, description: "Fragrant rice with mixed vegetables",  category: "Rice"       },
        { id: 603, name: "Samosas",              price:  6.99, description: "Crispy pastries with spiced potatoes", category: "Appetizers" },
        { id: 604, name: "Garlic Naan",          price:  3.99, description: "Freshly baked flatbread",              category: "Bread"      },
        { id: 605, name: "Mango Lassi",          price:  4.99, description: "Sweet yogurt drink",                   category: "Drinks"     },
      ],
    };

    const ORDER_STATUSES = [
      { key: 'pending',     label: 'Order Placed',     icon: 'üìã', detail: 'Your order has been received.' },
      { key: 'confirmed',   label: 'Confirmed',        icon: '‚úÖ', detail: 'The restaurant confirmed your order.' },
      { key: 'preparing',   label: 'Preparing',        icon: 'üë®‚Äçüç≥', detail: 'Your food is being prepared.' },
      { key: 'pickup',      label: 'Courier Assigned', icon: 'üöó', detail: 'Your courier is heading to the restaurant.' },
      { key: 'delivering',  label: 'On the Way',       icon: 'üìç', detail: 'Your courier is heading to you!' },
      { key: 'delivered',   label: 'Delivered',        icon: 'üéâ', detail: 'Enjoy your meal!' },
    ];

    // ‚îÄ‚îÄ SVG Icons ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const IcCart = () => <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg>;
    const IcSearch = () => <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>;
    const IcStar = () => <svg width="15" height="15" viewBox="0 0 24 24" fill="#00d9ff" stroke="#00d9ff" strokeWidth="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>;
    const IcClock = () => <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;
    const IcPlus = () => <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>;
    const IcMinus = () => <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round"><line x1="5" y1="12" x2="19" y2="12"/></svg>;
    const IcX = () => <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>;
    const IcCheck = () => <svg width="70" height="70" viewBox="0 0 24 24" fill="none" stroke="#ff6b35" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
    const IcUser = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>;
    const IcCard = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>;
    const IcMsg = () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>;
    const IcSend = () => <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>;

    // ‚îÄ‚îÄ App ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function App() {
      // Auth
      const [currentUser, setCurrentUser] = useState(null);
      const [authView, setAuthView]       = useState('login'); // login | register

      // Navigation
      const [view, setView] = useState('auth'); // auth | home | menu | cart | checkout | payment | confirmation | tracking

      // Restaurant / menu
      const [allRestaurants, setAllRestaurants] = useState([]);
      const [restaurants, setRestaurants]       = useState([]);
      const [selectedRestaurant, setSelectedRestaurant] = useState(null);
      const [menuData, setMenuData]             = useState(null);
      const [searchQuery, setSearchQuery]       = useState('');
      const [loading, setLoading]               = useState(false);
      const [backendAvailable, setBackendAvailable] = useState(null);

      // Cart
      const [cart, setCart] = useState([]);

      // Checkout
      const [customerName, setCustomerName]       = useState('');
      const [customerPhone, setCustomerPhone]     = useState('');
      const [deliveryAddress, setDeliveryAddress] = useState('');

      // Payment
      const [cardNumber, setCardNumber]   = useState('');
      const [cardExpiry, setCardExpiry]   = useState('');
      const [cardCVV, setCardCVV]         = useState('');
      const [cardName, setCardName]       = useState('');
      const [paymentError, setPaymentError] = useState('');

      // Order / tracking
      const [orderDetails, setOrderDetails]   = useState(null);
      const [orderStatusIdx, setOrderStatusIdx] = useState(0);
      const [assignedCourier, setAssignedCourier] = useState(null);

      // Chat
      const [chatOpen, setChatOpen]     = useState(false);
      const [chatInput, setChatInput]   = useState('');
      const [chatMessages, setChatMessages] = useState([]);
      const chatEndRef = useRef(null);

      // ‚îÄ‚îÄ Bootstrap ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      useEffect(() => {
        (async () => {
          try {
            const res = await fetch(`${API_URL}/restaurants`);
            if (!res.ok) throw new Error();
            const data = await res.json();
            setAllRestaurants(data); setRestaurants(data); setBackendAvailable(true);
          } catch {
            setAllRestaurants(MOCK_RESTAURANTS); setRestaurants(MOCK_RESTAURANTS); setBackendAvailable(false);
          }
        })();
      }, []);

      // Pre-fill checkout name/phone from logged-in user
      useEffect(() => {
        if (currentUser) { setCustomerName(currentUser.name); setCustomerPhone(currentUser.phone); }
      }, [currentUser]);

      // Auto-advance order status
      useEffect(() => {
        if (view !== 'tracking') return;
        if (orderStatusIdx >= ORDER_STATUSES.length - 1) return;
        const t = setTimeout(() => setOrderStatusIdx(i => i + 1), 7000);
        return () => clearTimeout(t);
      }, [view, orderStatusIdx]);

      // Scroll chat to bottom
      useEffect(() => { chatEndRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [chatMessages]);

      // ‚îÄ‚îÄ Auth ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      function AuthScreen() {
        const [email, setEmail]       = useState('');
        const [pass, setPass]         = useState('');
        const [name, setName]         = useState('');
        const [phone, setPhone]       = useState('');
        const [err, setErr]           = useState('');

        const login = () => {
          const u = MOCK_USERS.find(u => u.email === email && u.password === pass);
          if (!u) { setErr('Invalid email or password.'); return; }
          setCurrentUser(u); setView('home');
        };

        const register = () => {
          if (!name || !email || !pass || !phone) { setErr('Please fill in all fields.'); return; }
          if (MOCK_USERS.find(u => u.email === email)) { setErr('Email already in use.'); return; }
          const u = { id: Date.now(), name, email, password: pass, phone };
          MOCK_USERS.push(u);
          setCurrentUser(u); setView('home');
        };

        return (
          <div className="min-h-screen bg-[#0a0a0a] grid-pattern flex items-center justify-center px-4">
            <div className="w-full max-w-md animate-slide-up">
              <h1 className="title-font text-6xl text-white text-center mb-2">QUICKBITE</h1>
              <p className="text-gray-400 text-center mb-8 text-lg">Fast food, faster delivery.</p>

              <div className="flex mb-6 border-2 border-white">
                <button onClick={() => { setAuthView('login'); setErr(''); }}
                  className={`flex-1 py-3 font-bold text-lg transition-colors ${authView==='login' ? 'bg-[#ff6b35] text-white' : 'bg-transparent text-gray-400 hover:text-white'}`}>
                  LOGIN
                </button>
                <button onClick={() => { setAuthView('register'); setErr(''); }}
                  className={`flex-1 py-3 font-bold text-lg transition-colors ${authView==='register' ? 'bg-[#ff6b35] text-white' : 'bg-transparent text-gray-400 hover:text-white'}`}>
                  REGISTER
                </button>
              </div>

              <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow space-y-4">
                {authView === 'register' && (
                  <>
                    <div>
                      <label className="block text-gray-400 mb-1 font-bold text-sm">FULL NAME</label>
                      <input value={name} onChange={e => setName(e.target.value)} placeholder="Jane Smith"
                        className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                    </div>
                    <div>
                      <label className="block text-gray-400 mb-1 font-bold text-sm">PHONE</label>
                      <input value={phone} onChange={e => setPhone(e.target.value)} placeholder="555-0100"
                        className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                    </div>
                  </>
                )}
                <div>
                  <label className="block text-gray-400 mb-1 font-bold text-sm">EMAIL</label>
                  <input type="email" value={email} onChange={e => setEmail(e.target.value)} placeholder="you@example.com"
                    className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                </div>
                <div>
                  <label className="block text-gray-400 mb-1 font-bold text-sm">PASSWORD</label>
                  <input type="password" value={pass} onChange={e => setPass(e.target.value)} placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                </div>
                {err && <p className="text-red-400 font-bold text-sm">{err}</p>}
                <button onClick={authView === 'login' ? login : register}
                  className="w-full btn-primary text-white font-bold py-4 text-xl mt-2">
                  {authView === 'login' ? 'LOGIN' : 'CREATE ACCOUNT'}
                </button>
                {authView === 'login' && (
                  <p className="text-center text-gray-500 text-sm pt-1">
                    Demo: <span className="text-[#00d9ff]">demo@quickbite.com</span> / <span className="text-[#00d9ff]">password</span>
                  </p>
                )}
              </div>
            </div>
          </div>
        );
      }

      // ‚îÄ‚îÄ Search ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const handleSearch = useCallback(async (q) => {
  setSearchQuery(q);
  if (!q.trim()) { setRestaurants(allRestaurants); return; }
  if (backendAvailable) {
    try {
      const res = await fetch(`${API_URL}/search?query=${encodeURIComponent(q)}`);
      if (!res.ok) throw new Error();
      setRestaurants(await res.json()); return;
    } catch {}
  }
  const lq = q.toLowerCase();
  setRestaurants(allRestaurants.filter(r => {
    const matchesRestaurant = r.name.toLowerCase().includes(lq) || r.cuisine.toLowerCase().includes(lq);
    const menuItems = MOCK_MENUS[r.id] || [];
    const matchesMenu = menuItems.some(item =>
      item.name.toLowerCase().includes(lq) ||
      item.description.toLowerCase().includes(lq) ||
      item.category.toLowerCase().includes(lq)
    );
    return matchesRestaurant || matchesMenu;
  }));
}, [backendAvailable, allRestaurants]);

      // ‚îÄ‚îÄ Menu ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const loadMenu = async (id) => {
        setLoading(true);
        try {
          if (backendAvailable) {
            const res = await fetch(`${API_URL}/restaurants/${id}/menu`);
            const d = await res.json();
            setSelectedRestaurant(d.restaurant); setMenuData(d.menu);
          } else {
            setSelectedRestaurant(MOCK_RESTAURANTS.find(r => r.id === id));
            setMenuData(MOCK_MENUS[id] || []);
          }
          setView('menu');
        } catch(e) { console.error(e); }
        finally { setLoading(false); }
      };

      // ‚îÄ‚îÄ Cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const addToCart = (item) => setCart(p => {
        const ex = p.find(c => c.id === item.id);
        return ex ? p.map(c => c.id === item.id ? {...c, quantity: c.quantity+1} : c)
                  : [...p, {...item, quantity: 1}];
      });
      const removeFromCart = (id) => setCart(p => {
        const ex = p.find(c => c.id === id);
        return ex && ex.quantity > 1 ? p.map(c => c.id === id ? {...c, quantity: c.quantity-1} : c)
                                     : p.filter(c => c.id !== id);
      });
      const subtotal = () => cart.reduce((s,i) => s + i.price * i.quantity, 0);
      const total    = () => subtotal() + (selectedRestaurant?.deliveryFee || 0);
      const cartCount = cart.reduce((s,i) => s + i.quantity, 0);

      // ‚îÄ‚îÄ Payment ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const processPayment = () => {
        setPaymentError('');
        const clean = cardNumber.replace(/\s/g,'');
        if (clean.length < 16) { setPaymentError('Enter a valid 16-digit card number.'); return; }
        if (!cardExpiry.match(/^\d{2}\/\d{2}$/)) { setPaymentError('Enter expiry as MM/YY.'); return; }
        if (cardCVV.length < 3) { setPaymentError('Enter a valid CVV.'); return; }
        if (!cardName.trim()) { setPaymentError('Enter the name on your card.'); return; }
        finalizeOrder();
      };

      const finalizeOrder = () => {
        const courier = MOCK_COURIERS[Math.floor(Math.random() * MOCK_COURIERS.length)];
        setAssignedCourier(courier);
        const txId = 'QB-' + Math.floor(Math.random()*90000+10000);
        const payload = {
          id: Math.floor(Math.random()*9000)+1000,
          restaurantId: selectedRestaurant.id,
          items: cart,
          deliveryAddress, customerName, customerPhone,
          subtotal: subtotal(), deliveryFee: selectedRestaurant.deliveryFee, total: total(),
          status: 'pending', transactionId: txId,
          createdAt: new Date().toISOString(),
        };
        setOrderDetails(payload);
        setOrderStatusIdx(0);
        setChatMessages([{ from: 'bot', text: `Hi ${customerName.split(' ')[0]}! I'm ${courier.name}, your delivery courier. I'll keep you updated! üòä` }]);
        setCart([]);
        setView('confirmation');
      };

      // ‚îÄ‚îÄ Chat ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const sendChat = () => {
        if (!chatInput.trim()) return;
        const msg = chatInput.trim();
        setChatMessages(p => [...p, { from: 'user', text: msg }]);
        setChatInput('');
        const idx = Math.min(orderStatusIdx, COURIER_SCRIPTS.length - 1);
        setTimeout(() => {
          setChatMessages(p => [...p, { from: 'bot', text: COURIER_SCRIPTS[idx] }]);
        }, 1000 + Math.random() * 800);
      };

      // ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const goHome = () => { setView('home'); setSearchQuery(''); setRestaurants(allRestaurants); };
      const groupedMenu = (menuData || []).reduce((a, item) => { (a[item.category]=a[item.category]||[]).push(item); return a; }, {});

      const formatCard = (val) => val.replace(/\D/g,'').slice(0,16).replace(/(.{4})/g,'$1 ').trim();
      const formatExpiry = (val) => {
        const d = val.replace(/\D/g,'').slice(0,4);
        return d.length > 2 ? d.slice(0,2) + '/' + d.slice(2) : d;
      };

      // ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      const Header = () => (
        <header className="bg-black border-b-4 border-white sticky top-0 z-50">
          <div className="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
            <h1 className="title-font text-5xl cursor-pointer text-white" onClick={goHome}>QUICKBITE</h1>
            <div className="flex items-center gap-3">
              {backendAvailable === false && <span className="text-xs text-yellow-400 border border-yellow-400 px-2 py-1 font-bold">DEMO MODE</span>}
              {currentUser && (
                <div className="flex items-center gap-3">
                  <span className="text-gray-400 text-sm hidden md:block">üëã {currentUser.name.split(' ')[0]}</span>
                  <button onClick={() => { setCurrentUser(null); setView('auth'); setCart([]); }}
                    className="btn-secondary text-white px-4 py-2 text-sm font-bold">LOGOUT</button>
                </div>
              )}
              {view !== 'auth' && (
                <button onClick={() => setView('cart')}
                  className="relative bg-[#ff6b35] text-white px-5 py-2 font-bold border-2 border-white accent-shadow hover:-translate-x-0.5 hover:-translate-y-0.5 transition-transform flex items-center gap-2">
                  <IcCart /> CART
                  {cartCount > 0 && (
                    <span className="absolute -top-2 -right-2 bg-[#00d9ff] text-black w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs border-2 border-white">
                      {cartCount}
                    </span>
                  )}
                </button>
              )}
            </div>
          </div>
        </header>
      );

      // ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
      if (view === 'auth') return <AuthScreen />;

      return (
        <div className="min-h-screen bg-[#0a0a0a] text-white">
          <Header />
          <div className="grid-pattern min-h-screen">

            {/* HOME */}
            {view === 'home' && (
              <div className="max-w-7xl mx-auto px-6 py-12 animate-slide-up">
                <div className="text-center mb-14">
                  <h2 className="title-font text-8xl mb-3">FOOD <span className="text-[#ff6b35]">DELIVERED</span></h2>
                  <p className="text-xl text-gray-400 mb-8">Order from the best restaurants in your city</p>
                  <div className="max-w-2xl mx-auto relative">
                    <input type="text" placeholder="Search restaurants or cuisines..." value={searchQuery}
                      onChange={e => handleSearch(e.target.value)}
                      className="w-full px-6 py-5 text-xl bg-[#1a1a1a] border-2 border-white text-white placeholder-gray-500 accent-shadow focus:outline-none focus:border-[#00d9ff]" />
                    <div className="absolute right-5 top-1/2 -translate-y-1/2 text-gray-500 pointer-events-none"><IcSearch /></div>
                  </div>
                </div>
                {loading ? (
                  <div className="text-center py-20 text-2xl text-gray-500">Loading...</div>
                ) : restaurants.length === 0 ? (
                  <div className="text-center py-20">
                    <p className="text-2xl text-gray-500 mb-6">No results for "{searchQuery}"</p>
                    <button onClick={() => handleSearch('')} className="btn-primary text-white px-8 py-4 font-bold text-lg">CLEAR SEARCH</button>
                  </div>
                ) : (
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    {restaurants.map((r, i) => (
                      <div key={r.id} className="brutalist-card bg-[#1a1a1a] p-6 cursor-pointer animate-slide-up"
                        style={{ animationDelay: `${i*0.07}s` }} onClick={() => loadMenu(r.id)}>
                        <div className="text-6xl mb-4">{r.image}</div>
                        <h3 className="title-font text-3xl mb-1">{r.name}</h3>
                        <p className="text-gray-400 text-lg mb-4">{r.cuisine}</p>
                        <div className="flex items-center justify-between border-t-2 border-gray-700 pt-4">
                          <div className="flex items-center gap-1"><IcStar /><span className="font-bold text-lg ml-1">{r.rating}</span></div>
                          <div className="flex items-center text-gray-400 gap-1"><IcClock /><span>{r.deliveryTime}</span></div>
                          <div className="font-bold text-[#ff6b35] text-lg">${r.deliveryFee.toFixed(2)}</div>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            )}

            {/* MENU */}
            {view === 'menu' && selectedRestaurant && (
              <div className="max-w-5xl mx-auto px-6 py-10 animate-slide-up">
                <button onClick={goHome} className="mb-6 text-gray-400 hover:text-white transition-colors">‚Üê Back to restaurants</button>
                <div className="flex items-center gap-4 mb-10">
                  <span className="text-6xl">{selectedRestaurant.image}</span>
                  <div>
                    <h2 className="title-font text-5xl">{selectedRestaurant.name}</h2>
                    <p className="text-gray-400 text-lg">{selectedRestaurant.cuisine} ¬∑ ‚≠ê {selectedRestaurant.rating} ¬∑ {selectedRestaurant.deliveryTime}</p>
                  </div>
                </div>
                {Object.entries(groupedMenu).map(([cat, items]) => (
                  <div key={cat} className="mb-10">
                    <h3 className="title-font text-3xl text-[#ff6b35] mb-4 border-b-2 border-gray-700 pb-2">{cat}</h3>
                    <div className="space-y-4">
                      {items.map(item => {
                        const inCart = cart.find(c => c.id === item.id);
                        return (
                          <div key={item.id} className="bg-[#1a1a1a] border-2 border-white p-5 flex justify-between items-center">
                            <div>
                              <h4 className="text-xl font-bold">{item.name}</h4>
                              <p className="text-gray-400 text-sm">{item.description}</p>
                              <p className="text-[#00d9ff] font-bold text-lg mt-1">${item.price.toFixed(2)}</p>
                            </div>
                            <div className="ml-4 shrink-0">
                              {inCart ? (
                                <div className="flex items-center bg-[#ff6b35] border-2 border-white">
                                  <button onClick={() => removeFromCart(item.id)} className="p-2 hover:bg-white hover:text-black transition-colors"><IcMinus /></button>
                                  <span className="px-4 font-bold">{inCart.quantity}</span>
                                  <button onClick={() => addToCart(item)} className="p-2 hover:bg-white hover:text-black transition-colors"><IcPlus /></button>
                                </div>
                              ) : (
                                <button onClick={() => addToCart(item)} className="btn-primary text-white px-4 py-2 font-bold flex items-center gap-1"><IcPlus /> ADD</button>
                              )}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* CART */}
            {view === 'cart' && (
              <div className="max-w-4xl mx-auto px-6 py-10 animate-slide-up">
                <button onClick={() => setView(selectedRestaurant ? 'menu' : 'home')} className="mb-6 text-gray-400 hover:text-white transition-colors">‚Üê Continue shopping</button>
                <h2 className="title-font text-6xl mb-8">YOUR CART</h2>
                {cart.length === 0 ? (
                  <div className="text-center py-20 bg-[#1a1a1a] border-2 border-gray-700">
                    <div className="flex justify-center mb-4 text-gray-600"><IcCart /></div>
                    <p className="text-2xl text-gray-500 mb-4">Your cart is empty</p>
                    <button onClick={goHome} className="btn-primary text-white px-8 py-4 font-bold text-lg">BROWSE RESTAURANTS</button>
                  </div>
                ) : (
                  <>
                    <div className="space-y-4 mb-8">
                      {cart.map(item => (
                        <div key={item.id} className="bg-[#1a1a1a] border-2 border-white p-5 flex justify-between items-center">
                          <div className="flex-1">
                            <h3 className="text-xl font-bold">{item.name}</h3>
                            <p className="text-gray-400">${item.price.toFixed(2)} each</p>
                          </div>
                          <div className="flex items-center gap-4">
                            <div className="flex items-center bg-[#ff6b35] border-2 border-white">
                              <button onClick={() => removeFromCart(item.id)} className="p-2 hover:bg-white hover:text-black transition-colors"><IcMinus /></button>
                              <span className="px-5 font-bold">{item.quantity}</span>
                              <button onClick={() => addToCart(item)} className="p-2 hover:bg-white hover:text-black transition-colors"><IcPlus /></button>
                            </div>
                            <p className="font-bold text-[#00d9ff] w-20 text-right">${(item.price*item.quantity).toFixed(2)}</p>
                            <button onClick={() => setCart(p => p.filter(c => c.id !== item.id))} className="text-gray-500 hover:text-red-400 transition-colors"><IcX /></button>
                          </div>
                        </div>
                      ))}
                    </div>
                    <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow">
                      <h3 className="title-font text-3xl mb-4">ORDER SUMMARY</h3>
                      <div className="space-y-2 text-lg mb-6">
                        <div className="flex justify-between"><span className="text-gray-400">Subtotal</span><span className="font-bold">${subtotal().toFixed(2)}</span></div>
                        <div className="flex justify-between"><span className="text-gray-400">Delivery Fee</span><span className="font-bold">${(selectedRestaurant?.deliveryFee||0).toFixed(2)}</span></div>
                        <div className="border-t-2 border-gray-700 pt-3 flex justify-between text-2xl">
                          <span className="font-bold">Total</span><span className="font-bold text-[#ff6b35]">${total().toFixed(2)}</span>
                        </div>
                      </div>
                      <button onClick={() => setView('checkout')} className="w-full btn-primary text-white font-bold py-5 text-xl">PROCEED TO CHECKOUT</button>
                    </div>
                  </>
                )}
              </div>
            )}

            {/* CHECKOUT */}
            {view === 'checkout' && (
              <div className="max-w-2xl mx-auto px-6 py-10 animate-slide-up">
                <button onClick={() => setView('cart')} className="mb-6 text-gray-400 hover:text-white transition-colors">‚Üê Back to cart</button>
                <h2 className="title-font text-6xl mb-8">CHECKOUT</h2>
                <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow space-y-5">
                  <h3 className="title-font text-2xl text-[#ff6b35] flex items-center gap-2"><IcUser /> DELIVERY DETAILS</h3>
                  {[
                    { label: 'Full Name',        value: customerName,    set: setCustomerName,    type: 'text', ph: 'Jane Smith' },
                    { label: 'Phone Number',     value: customerPhone,   set: setCustomerPhone,   type: 'tel',  ph: '555-0100'   },
                    { label: 'Delivery Address', value: deliveryAddress, set: setDeliveryAddress, type: 'text', ph: '123 Main St, City' },
                  ].map(({ label, value, set, type, ph }) => (
                    <div key={label}>
                      <label className="block text-gray-400 mb-1 font-bold text-sm">{label.toUpperCase()}</label>
                      <input type={type} value={value} onChange={e => set(e.target.value)} placeholder={ph}
                        className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                    </div>
                  ))}
                  <div className="border-t-2 border-gray-700 pt-4 space-y-2 text-lg">
                    <div className="flex justify-between"><span className="text-gray-400">Subtotal</span><span>${subtotal().toFixed(2)}</span></div>
                    <div className="flex justify-between"><span className="text-gray-400">Delivery</span><span>${(selectedRestaurant?.deliveryFee||0).toFixed(2)}</span></div>
                    <div className="flex justify-between text-2xl font-bold pt-2 border-t border-gray-700">
                      <span>Total</span><span className="text-[#ff6b35]">${total().toFixed(2)}</span>
                    </div>
                  </div>
                  <button onClick={() => {
                    if (!customerName || !customerPhone || !deliveryAddress) { alert('Please fill in all fields.'); return; }
                    setView('payment');
                  }} className="w-full btn-primary text-white font-bold py-5 text-xl">
                    CONTINUE TO PAYMENT
                  </button>
                </div>
              </div>
            )}

            {/* PAYMENT */}
            {view === 'payment' && (
              <div className="max-w-2xl mx-auto px-6 py-10 animate-slide-up">
                <button onClick={() => setView('checkout')} className="mb-6 text-gray-400 hover:text-white transition-colors">‚Üê Back to checkout</button>
                <h2 className="title-font text-6xl mb-8">PAYMENT</h2>
                <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow space-y-5 mb-6">
                  <h3 className="title-font text-2xl text-[#ff6b35] flex items-center gap-2"><IcCard /> CARD DETAILS</h3>
                  {/* Card preview */}
                  <div className="bg-gradient-to-br from-[#ff6b35] to-[#c94a1a] border-2 border-white p-6 rounded-sm mb-2">
                    <p className="text-white font-bold text-xl tracking-widest mb-4">{cardNumber || '‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}</p>
                    <div className="flex justify-between items-end">
                      <div>
                        <p className="text-orange-200 text-xs mb-1">CARDHOLDER</p>
                        <p className="text-white font-bold">{cardName || 'YOUR NAME'}</p>
                      </div>
                      <div className="text-right">
                        <p className="text-orange-200 text-xs mb-1">EXPIRES</p>
                        <p className="text-white font-bold">{cardExpiry || 'MM/YY'}</p>
                      </div>
                    </div>
                  </div>
                  <div>
                    <label className="block text-gray-400 mb-1 font-bold text-sm">NAME ON CARD</label>
                    <input value={cardName} onChange={e => setCardName(e.target.value)} placeholder="Jane Smith"
                      className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                  </div>
                  <div>
                    <label className="block text-gray-400 mb-1 font-bold text-sm">CARD NUMBER</label>
                    <input value={cardNumber} onChange={e => setCardNumber(formatCard(e.target.value))} placeholder="1234 5678 9012 3456" maxLength="19"
                      className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff] tracking-widest" />
                  </div>
                  <div className="flex gap-4">
                    <div className="flex-1">
                      <label className="block text-gray-400 mb-1 font-bold text-sm">EXPIRY</label>
                      <input value={cardExpiry} onChange={e => setCardExpiry(formatExpiry(e.target.value))} placeholder="MM/YY" maxLength="5"
                        className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                    </div>
                    <div className="flex-1">
                      <label className="block text-gray-400 mb-1 font-bold text-sm">CVV</label>
                      <input type="password" value={cardCVV} onChange={e => setCardCVV(e.target.value.slice(0,4))} placeholder="‚Ä¢‚Ä¢‚Ä¢"
                        className="w-full px-4 py-3 bg-black border-2 border-gray-700 text-white focus:outline-none focus:border-[#00d9ff]" />
                    </div>
                  </div>
                  {paymentError && <p className="text-red-400 font-bold text-sm">{paymentError}</p>}
                  <div className="border-t-2 border-gray-700 pt-4 flex justify-between text-2xl font-bold">
                    <span>Total</span><span className="text-[#ff6b35]">${total().toFixed(2)}</span>
                  </div>
                  <button onClick={processPayment} className="w-full btn-primary text-white font-bold py-5 text-xl">
                    PAY ${total().toFixed(2)}
                  </button>
                  <p className="text-center text-gray-600 text-xs">üîí This is a demo ‚Äî no real payment is processed.</p>
                </div>
              </div>
            )}

            {/* CONFIRMATION */}
            {view === 'confirmation' && orderDetails && (
              <div className="max-w-2xl mx-auto px-6 py-16 text-center animate-slide-up">
                <div className="flex justify-center mb-4"><IcCheck /></div>
                <h2 className="title-font text-6xl mb-3">ORDER <span className="text-[#ff6b35]">CONFIRMED!</span></h2>
                <p className="text-gray-400 text-lg mb-1">Order #{orderDetails.id}</p>
                <p className="text-gray-500 text-sm mb-8">Transaction: {orderDetails.transactionId}</p>
                <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow text-left mb-6 space-y-3">
                  <div className="flex justify-between text-lg"><span className="text-gray-400">Delivering to</span><span className="font-bold">{orderDetails.deliveryAddress}</span></div>
                  <div className="flex justify-between text-lg"><span className="text-gray-400">Total charged</span><span className="font-bold text-[#ff6b35]">${orderDetails.total?.toFixed(2)}</span></div>
                  <div className="flex justify-between text-lg"><span className="text-gray-400">Est. delivery</span><span className="font-bold">~30 min</span></div>
                  {assignedCourier && (
                    <div className="border-t-2 border-gray-700 pt-3 flex justify-between text-lg">
                      <span className="text-gray-400">Your courier</span>
                      <span className="font-bold">{assignedCourier.avatar} {assignedCourier.name}</span>
                    </div>
                  )}
                </div>
                <button onClick={() => setView('tracking')} className="w-full btn-primary text-white font-bold py-5 text-xl mb-3">
                  TRACK MY ORDER
                </button>
                <button onClick={() => { goHome(); setOrderDetails(null); setSelectedRestaurant(null); setMenuData(null); }}
                  className="w-full btn-secondary text-white font-bold py-4 text-lg">
                  ORDER AGAIN
                </button>
              </div>
            )}

            {/* TRACKING */}
            {view === 'tracking' && orderDetails && (
              <div className="max-w-2xl mx-auto px-6 py-10 animate-slide-up">
                <h2 className="title-font text-5xl mb-2">ORDER TRACKING</h2>
                <p className="text-gray-400 mb-8">Order #{orderDetails.id}</p>

                {/* Status stepper */}
                <div className="bg-[#1a1a1a] border-2 border-white p-8 accent-shadow mb-6">
                  {ORDER_STATUSES.map((s, i) => {
                    const done   = i < orderStatusIdx;
                    const active = i === orderStatusIdx;
                    return (
                      <div key={s.key} className="flex items-start gap-4">
                        <div className="flex flex-col items-center">
                          <div className={`w-10 h-10 rounded-full border-2 flex items-center justify-center text-lg font-bold transition-all duration-500
                            ${done ? 'step-done text-black' : active ? 'step-active text-white' : 'step-inactive text-gray-600'}`}>
                            {done ? '‚úì' : s.icon}
                          </div>
                          {i < ORDER_STATUSES.length - 1 && (
                            <div className={`w-0.5 h-8 mt-1 transition-all duration-500 ${done ? 'step-line-done' : 'step-line-inactive'}`} />
                          )}
                        </div>
                        <div className="pb-6">
                          <p className={`font-bold text-lg ${active ? 'text-[#ff6b35]' : done ? 'text-[#00d9ff]' : 'text-gray-600'}`}>{s.label}</p>
                          {active && <p className="text-gray-400 text-sm mt-0.5">{s.detail}</p>}
                        </div>
                      </div>
                    );
                  })}
                </div>

                {/* Courier info */}
                {assignedCourier && (
                  <div className="bg-[#1a1a1a] border-2 border-white p-6 mb-6">
                    <h3 className="title-font text-2xl mb-4 text-[#00d9ff]">YOUR COURIER</h3>
                    <div className="flex items-center gap-4">
                      <div className="text-5xl">{assignedCourier.avatar}</div>
                      <div>
                        <p className="font-bold text-xl">{assignedCourier.name}</p>
                        <p className="text-gray-400">{assignedCourier.vehicle}</p>
                        <p className="text-[#ff6b35] font-bold">{assignedCourier.phone}</p>
                      </div>
                      <button onClick={() => setChatOpen(o => !o)}
                        className="ml-auto btn-primary text-white px-4 py-2 font-bold flex items-center gap-2">
                        <IcMsg /> CHAT {chatMessages.filter(m=>m.from==='bot').length > 0 && <span className="bg-white text-black rounded-full w-5 h-5 text-xs flex items-center justify-center">{chatMessages.filter(m=>m.from==='bot').length}</span>}
                      </button>
                    </div>

                    {/* Chat panel */}
                    {chatOpen && (
                      <div className="mt-4 border-t-2 border-gray-700 pt-4">
                        <div className="h-48 overflow-y-auto space-y-2 mb-3 pr-1">
                          {chatMessages.map((m, i) => (
                            <div key={i} className={`flex ${m.from === 'user' ? 'justify-end' : 'justify-start'}`}>
                              <div className={`max-w-xs px-3 py-2 text-sm ${m.from === 'user' ? 'chat-bubble-user text-white' : 'chat-bubble-bot text-gray-200'}`}>
                                {m.from === 'bot' && <span className="font-bold text-[#00d9ff] text-xs block mb-0.5">{assignedCourier.name}</span>}
                                {m.text}
                              </div>
                            </div>
                          ))}
                          <div ref={chatEndRef} />
                        </div>
                        <div className="flex gap-2">
                          <input value={chatInput} onChange={e => setChatInput(e.target.value)}
                            onKeyDown={e => e.key === 'Enter' && sendChat()}
                            placeholder="Message your courier..."
                            className="flex-1 px-3 py-2 bg-black border-2 border-gray-700 text-white text-sm focus:outline-none focus:border-[#00d9ff]" />
                          <button onClick={sendChat} className="btn-primary text-white px-4 py-2"><IcSend /></button>
                        </div>
                      </div>
                    )}
                  </div>
                )}

                {orderStatusIdx === ORDER_STATUSES.length - 1 && (
                  <div className="text-center py-4">
                    <p className="text-2xl mb-4">üéâ Your order has been delivered!</p>
                    <button onClick={() => { goHome(); setOrderDetails(null); setSelectedRestaurant(null); setMenuData(null); }}
                      className="btn-primary text-white px-10 py-4 font-bold text-lg">ORDER AGAIN</button>
                  </div>
                )}
              </div>
            )}

          </div>
          <footer className="bg-black border-t-4 border-white py-8 mt-20">
            <div className="max-w-7xl mx-auto px-6 text-center">
              <p className="text-gray-500">¬© 2026 QUICKBITE. Fast food, faster delivery.</p>
            </div>
          </footer>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>